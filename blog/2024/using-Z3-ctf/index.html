<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>SMT Solvers for CTFs | Landen Doty</title>
    <meta name="author" content="Landen  Doty">
    <meta name="description" content="Writing a Z3 Python script to solve a CTF">


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous">

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light">

    <!-- Styles -->
    
    <link rel="shortcut icon" href="/assets/img/ld.png">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://landoty.github.io/blog/2024/using-Z3-ctf/">
    
    <!-- Dark Mode -->
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark">

    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/dark_mode.js"></script>
    

  </head>

  <!-- Body -->
  <body class="fixed-top-nav sticky-bottom-footer">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="/">Landen Doty</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">about</a>
              </li>
              
              <!-- Blog -->
              <li class="nav-item active">
                <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a>
              </li>

              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/projects/">projects</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/cv/">cv</a>
              </li>

              <!-- Toogle theme mode -->
              <li class="toggle-container">
                <button id="light-toggle" title="Change theme">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </button>
              </li>
            </ul>
          </div>
        </div>
      </nav>

      <!-- Scrolling Progress Bar -->
      <progress id="progress" value="0">
        <div class="progress-container">
          <span class="progress-bar"></span>
        </div>
      </progress>
    </header>


    <!-- Content -->
    <div class="container mt-5">
      <!-- _layouts/post.html -->
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

<div class="post">

  <header class="post-header">
    <h1 class="post-title">SMT Solvers for CTFs</h1>
    <p class="post-meta">March 2, 2024</p>
    <p class="post-tags">
      <a href="/blog/2024"> <i class="fas fa-calendar fa-sm"></i> 2024 </a>
        ·  
        <a href="/blog/tag/ctf">
          <i class="fas fa-hashtag fa-sm"></i> ctf</a>  
          

    </p>
  </header>

  <article class="post-content">
    <h3 id="what-is-smt">What is SMT?</h3>

<p>Satisfiability modulo theories, or <strong>SMT</strong> for short, is the problem of determining whether a particular formula is <em>satisfiable</em>. It is a common topic in computer science theory and is a generalization of <em>Boolean Satisfiability</em>, or <strong>SAT</strong>, which only handles boolean (True/False) formulas. SMT is widely used in program analysis and verification and is readily available in many popular programming languages (<a href="https://github.com/Z3Prover/z3" rel="external nofollow noopener" target="_blank">Z3 Python</a>).</p>

<p>SAT is, as far as we know, NP-complete, so SMT is NP-hard. However, researchers have determined a number theories that lead to <em>decidable</em> SMT problems and are added directly into the logic of SMT solvers.</p>

<h3 id="solvers">Solvers</h3>

<p>SMT <em>solvers</em> are automated tools that aid practicioners in solving relevant SMT problems. For example, SMT solvers are often used in <em>symbolic execution</em> engines to determine particular useful inputs to a program. Solvers can also be invoked directly for smaller problems, like CTFs which will be demonstrated here.</p>

<h4 id="example-smt">Example SMT</h4>

\[x &gt; 0 \wedge x \leq 5 \wedge x \bmod 3 = 0\]

<p>Obviously, this example is simple to evaluate - \(x = 3\) - but it goes to show the additional expressiveness of SMT in comparison to SAT. We can expand this example a bit to show that compound expressions can also be used in SMT.</p>

\[x, y &gt; 0 \wedge x + y \leq 5 \wedge x \bmod 3 = 0\]

<p>Here, the solver will determine satisfiable values for both \(x\) and \(y\), returning the set, \(\{x: 3, y: 2\}\).</p>

<h3 id="z3py">Z3Py</h3>

<p>Z3 is a popular SMT solver/prover developed by <a href="https://www.microsoft.com/en-us/research/project/z3-3/" rel="external nofollow noopener" target="_blank">Microsoft</a> and is the target of many software engineering and verification tasks. It is avaiable in many mainstream languages and can be installed via their respective package managers. Among them, Python provides a seemless API that enables quick scripting that applies nicely to CTF challenges.</p>

<h4 id="install">Install</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>pip <span class="nb">install </span>z3-solver
</code></pre></div></div>

<h4 id="basic-z3-example">Basic Z3 Example</h4>

<p>The examples from above, solved using Z3Py</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">z3</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">x</span> <span class="o">=</span> <span class="nc">Int</span><span class="p">(</span><span class="sh">'</span><span class="s">x</span><span class="sh">'</span><span class="p">)</span> <span class="c1"># creating a Z3-aware variable, "x"
</span><span class="nf">solve</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<p>Running this, we should expect \(x = 3\), as above.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python3 ./z3-example.py
<span class="o">[</span>x <span class="o">=</span> 3]
</code></pre></div></div>
<h4 id="using-the-solver-object">Using the solver object</h4>

<p>Z3Py also provides a solver object that can be instantiated to manage the constraint environment. Here, multiple constraints can be added incrementally to the solver. We can even check the state of the solver by printing it.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">z3</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">solver</span> <span class="o">=</span> <span class="nc">Solver</span><span class="p">()</span> <span class="c1"># instantiate a solver object
</span>
<span class="n">x</span> <span class="o">=</span> <span class="nc">Int</span><span class="p">(</span><span class="sh">'</span><span class="s">x</span><span class="sh">'</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="nc">Int</span><span class="p">(</span><span class="sh">'</span><span class="s">y</span><span class="sh">'</span><span class="p">)</span>

<span class="n">solver</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">x</span>  <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># add multiple constraints at once
</span><span class="n">solver</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">)</span> <span class="c1"># add complex expression as a constraint
</span><span class="n">solver</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">x</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="n">solver</span><span class="p">)</span> <span class="c1"># get the current state of the solver
</span></code></pre></div></div>

<p>Running this, we now get the set of constraints specified above.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python3 ./z3-example.py
<span class="o">[</span>x <span class="o">&gt;</span> 0, y <span class="o">&gt;</span> 0, x + y <span class="o">&gt;=</span> 5, x%3 <span class="o">==</span> 0]
</code></pre></div></div>

<p>In some cases, it may not be necessary to know <em>what</em> the satisfying values are, just <em>if</em> they can be satisfied. The solver allows us to check this using the <code class="language-plaintext highlighter-rouge">check()</code> method.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="bp">...</span>
<span class="nf">print</span><span class="p">(</span><span class="n">solver</span><span class="p">.</span><span class="nf">check</span><span class="p">())</span>
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python3 ./z3-example.py
sat
</code></pre></div></div>

<p>Now that we know the specified constraints are satisfiable, we can get a <em>model</em> of the constraints to retrieve satisfying values for \(x\) and \(y\).</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="bp">...</span>
<span class="nf">print</span><span class="p">(</span><span class="n">solver</span><span class="p">.</span><span class="nf">model</span><span class="p">())</span>
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python3 ./z3-example.py
<span class="o">[</span>x <span class="o">=</span> 3, y <span class="o">=</span> 2]
</code></pre></div></div>

<h3 id="example-ctf-solution">Example CTF Solution</h3>

<p>Sparing the manual binary RE work, I came across a simple CTF challenge that seemed like a good candiate for SMT rather than other techniques (fuzzing, etc.).</p>

<p>The basic overview of the goes as follows:</p>

<ol>
  <li>Program takes 17 characters as input from stdin and stores in an array</li>
  <li>Swap the 12th and 16th index</li>
  <li>XOR each even index with 0xe0</li>
  <li>XOR each odd index with 0x3c</li>
  <li>Sort the array in ascending order</li>
  <li>Compare the resulting array with a key array, returning the flag if they match</li>
</ol>

<p>This particular challenge outputs the key array values, but it could also be extracted from further analysis, if necessary.</p>

<h4 id="modeling-the-arrays">Modeling the arrays</h4>

<p>To solve this challenge, we’ll need to use the Z3 <code class="language-plaintext highlighter-rouge">BitVec</code> object in order to perform the bitwise XOR. Note, <code class="language-plaintext highlighter-rouge">BitVec</code> requires the bit length to be specified.</p>

<p>List comprehension can be used here instead of instantiating 17 separate <code class="language-plaintext highlighter-rouge">BitVec</code> variables. Again, the output list was determined from the output of the challenge. We also use an intermediate <code class="language-plaintext highlighter-rouge">xor</code> list - more on this later.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">z3</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">17</span>

<span class="n">inp</span> <span class="o">=</span> <span class="p">[</span><span class="nc">BitVec</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">x_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
<span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x4b</span><span class="p">,</span> <span class="mh">0x4e</span><span class="p">,</span> <span class="mh">0x4f</span><span class="p">,</span>  <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0x5d</span><span class="p">,</span> <span class="mh">0x82</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0x8b</span><span class="p">,</span> <span class="mh">0x8d</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">,</span> <span class="mh">0x96</span><span class="p">]</span>
<span class="n">xor</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div></div>

<h4 id="swapping">Swapping</h4>

<p>It’s much simpler to swap the input now, before specifying constraints, than deriving some constraint that says input indeces 12 and 16 should be equal to some other indeces after XOR and sort.</p>

<p>Think how specifying a constraint like this might over-constrain possible solutions to the challenge…</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="bp">...</span>
<span class="n">solver</span> <span class="o">=</span> <span class="nc">Solver</span><span class="p">()</span>

<span class="n">inp</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="n">inp</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="n">inp</span><span class="p">[</span><span class="mi">16</span><span class="p">],</span> <span class="n">inp</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span>
</code></pre></div></div>

<h4 id="xor">XOR</h4>

<p>We can simply iterate over the input list and specify constraints for each index of the output list after the XOR operations.</p>

<p>Note, that we <em>must</em> also constrain the XOR keys since the BitVec constructor doesn’t take a literal value parameter. I.e., you can’t do something like <code class="language-plaintext highlighter-rouge">BitVec(0xAA)</code> to create a BitVec that holds the hexadecimal value 0xAA.</p>

<p>Also note that the result of the XOR operation is added to the intermediate <code class="language-plaintext highlighter-rouge">xor</code> list. This will help us specifiy constraints for sorting.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="bp">...</span>
<span class="n">xor_even</span> <span class="o">=</span> <span class="nc">BitVec</span><span class="p">(</span><span class="sh">'</span><span class="s">x_even</span><span class="sh">'</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="n">xor_odd</span> <span class="o">=</span> <span class="nc">BitVec</span><span class="p">(</span><span class="sh">'</span><span class="s">x_odd</span><span class="sh">'</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="c1"># Must constrain the XOR keys
</span><span class="n">solver</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">xor_even</span> <span class="o">==</span> <span class="mh">0xe0</span><span class="p">)</span>
<span class="n">solver</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">xor_odd</span> <span class="o">==</span> <span class="mh">0x3c</span><span class="p">)</span>

<span class="n">xor_result</span> <span class="o">=</span> <span class="bp">None</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
	<span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
		<span class="n">xor_result</span> <span class="o">=</span> <span class="n">inp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">xor_even</span>
		<span class="n">solver</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">xor_result</span> <span class="o">==</span> <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">xor_result</span> <span class="o">=</span> <span class="n">inp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">xor_odd</span>
		<span class="n">solver</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">xor_result</span> <span class="o">==</span> <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

	<span class="n">xor</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">xor_result</span><span class="p">)</span> <span class="c1">## Add result of XOR to xor list
</span></code></pre></div></div>

<h4 id="sort">Sort</h4>

<p>Now, we can iterate over the <code class="language-plaintext highlighter-rouge">xor</code> list, which contains the bitwise XOR operations, and specify that it must be sorted in ascending order.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="bp">...</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">solver</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">xor</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">xor</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div></div>

<h4 id="print-constraints">Print constraints</h4>

<p>While not included in my actual solution, we can check the constraints we’ve specified as done in the previous example. This demonstrates why using the <code class="language-plaintext highlighter-rouge">Solver</code> object is preferred when working with complex environments.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">print</span><span class="p">(</span><span class="n">solver</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python3 ./ctf-z3.py
<span class="o">[</span>x_even <span class="o">==</span> 224,
 x_odd <span class="o">==</span> 60,
 x_0 ^ x_even <span class="o">==</span> 73,
 x_1 ^ x_odd <span class="o">==</span> 75,
 x_2 ^ x_even <span class="o">==</span> 78,
 x_3 ^ x_odd <span class="o">==</span> 79,
 x_4 ^ x_even <span class="o">==</span> 85,
 x_5 ^ x_odd <span class="o">==</span> 85,
 x_6 ^ x_even <span class="o">==</span> 89,
...
 x_0 ^ x_even &lt;<span class="o">=</span> x_1 ^ x_odd,
 x_1 ^ x_odd &lt;<span class="o">=</span> x_2 ^ x_even,
 x_2 ^ x_even &lt;<span class="o">=</span> x_3 ^ x_odd,
 x_3 ^ x_odd &lt;<span class="o">=</span> x_4 ^ x_even,
 x_4 ^ x_even &lt;<span class="o">=</span> x_5 ^ x_odd,
 x_5 ^ x_odd &lt;<span class="o">=</span> x_6 ^ x_even,
...]
</code></pre></div></div>

<h4 id="check-satisfiability-and-get-solution">Check satisfiability and get solution</h4>

<p>Finally, we can check if the constraints we’ve specified for the challenge can be satisfied. If they are, we can get numeric, human-readable values or use the <code class="language-plaintext highlighter-rouge">sys</code> library to write their raw byte values to <code class="language-plaintext highlighter-rouge">stdout</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="n">solver</span><span class="p">.</span><span class="nf">check</span><span class="p">()</span> <span class="o">==</span> <span class="n">sat</span><span class="p">:</span>
	<span class="n">model</span> <span class="o">=</span> <span class="n">solver</span><span class="p">.</span><span class="nf">model</span><span class="p">()</span>
	<span class="n">solution</span> <span class="o">=</span> <span class="p">[</span><span class="n">model</span><span class="p">.</span><span class="nf">evaluate</span><span class="p">(</span><span class="n">inp</span><span class="p">[</span><span class="n">i</span><span class="p">]).</span><span class="nf">as_long</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
	<span class="n">solution</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="n">solution</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="mi">16</span><span class="p">],</span> <span class="n">solution</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span> <span class="c1">## Readable solution
</span>
    <span class="sh">'''</span><span class="s"> Raw byte solution
	solution = bytes(tmp)
	sys.stdout.buffer.write(solution)
    </span><span class="sh">'''</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python3 ./ctf-z3.py
<span class="o">[</span>169, 119, 174, 115, 181, 105, 185, 97, 98, 186, 104, 183, 118, 175, 115, 175, 109]
</code></pre></div></div>

<h3 id="final-thoughts">Final Thoughts</h3>

<p>SMT is one of those interesting pieces of computer science theory that applies to practical problems in a relatively straightforward way. Tools like Z3 make it easily accessible for quick problems like CTFs, but have also seen recent attention in large projects.</p>

<p>A few useful resources for more SMT-based work:</p>

<p><a href="https://smt-workshop.cs.uiowa.edu/2023/" rel="external nofollow noopener" target="_blank">SMT International Workshop</a><br>
<a href="https://www.usenix.org/system/files/conference/woot12/woot12-final26.pdf" rel="external nofollow noopener" target="_blank">SMT Solvers for Software Security</a><br>
<a href="https://docs.angr.io/en/latest/core-concepts/solver.html" rel="external nofollow noopener" target="_blank">Constraint solving in Symbolic Execution (Angr)</a></p>

  </article>


  
    
    <br>
    <hr>
    <br>
    <ul class="list-disc pl-8"></ul>

    <!-- Adds related posts to the end of an article -->
    <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2>
    <p class="mb-2">Here are some more articles you might like to read next:</p>
  

  <li class="my-2">
    <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/my-research/">Accelerating Rust Binary RE - Ideas and Goals</a>
  </li>

  

  <li class="my-2">
    <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/what-im-reading/">Reading list</a>
  </li>

  

  <li class="my-2">
    <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/htb-exatlon/">Hack the Box - Exatlon Writeup</a>
  </li>

  

  <li class="my-2">
    <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/pwnCollege-revEng/">Pwn.College Reverse Engineering</a>
  </li>

</div>

    </div>

    <!-- Footer -->    <footer class="sticky-bottom mt-5">
      <div class="container">
        © Copyright 2024 Landen  Doty. 
      </div>
    </footer>

    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/masonry.js" type="text/javascript"></script>
    
  <!-- Medium Zoom JS -->
  <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script>
  <script defer src="/assets/js/zoom.js"></script><!-- Load Common JS -->
  <script defer src="/assets/js/common.js"></script>
  <script defer src="/assets/js/copy_code.js" type="text/javascript"></script>

    

    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    
    

<!-- Scrolling Progress Bar -->
<script type="text/javascript">
  /*
   * This JavaScript code has been adapted from the article 
   * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar, 
   * published on the website https://css-tricks.com on the 7th of May, 2014.
   * Couple of changes were made to the original code to make it compatible 
   * with the `al-foio` theme.
   */
  const progressBar = $("#progress");
  /*
   * We set up the bar after all elements are done loading.
   * In some cases, if the images in the page are larger than the intended
   * size they'll have on the page, they'll be resized via CSS to accomodate
   * the desired size. This mistake, however, breaks the computations as the
   * scroll size is computed as soon as the elements finish loading.
   * To account for this, a minimal delay was introduced before computing the
   * values.
   */
  window.onload = function () {
    setTimeout(progressBarSetup, 50);
  };
  /*
   * We set up the bar according to the browser.
   * If the browser supports the progress element we use that.
   * Otherwise, we resize the bar thru CSS styling
   */
  function progressBarSetup() {
    if ("max" in document.createElement("progress")) {
      initializeProgressElement();
      $(document).on("scroll", function() {
        progressBar.attr({ value: getCurrentScrollPosition() });
      });
      $(window).on("resize", initializeProgressElement);
    } else {
      resizeProgressBar();
      $(document).on("scroll", resizeProgressBar);
      $(window).on("resize", resizeProgressBar);
    }
  }
  /*
   * The vertical scroll position is the same as the number of pixels that
   * are hidden from view above the scrollable area. Thus, a value > 0 is
   * how much the user has scrolled from the top
   */
  function getCurrentScrollPosition() {
    return $(window).scrollTop();
  }

  function initializeProgressElement() {
    let navbarHeight = $("#navbar").outerHeight(true);
    $("body").css({ "padding-top": navbarHeight });
    $("progress-container").css({ "padding-top": navbarHeight });
    progressBar.css({ top: navbarHeight });
    progressBar.attr({
      max: getDistanceToScroll(),
      value: getCurrentScrollPosition(),
    });
  }
  /*
   * The offset between the html document height and the browser viewport
   * height will be greater than zero if vertical scroll is possible.
   * This is the distance the user can scroll
   */
  function getDistanceToScroll() {
    return $(document).height() - $(window).height();
  }

  function resizeProgressBar() {
    progressBar.css({ width: getWidthPercentage() + "%" });
  }
  // The scroll ratio equals the percentage to resize the bar
  function getWidthPercentage() {
    return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
  }
</script>

  </body>
</html>
